<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Search results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='/css/search-style.css')}}">
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top bg-primary navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="http://127.0.0.1:8080/welcome">Booking.drexel</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto align-items-center">
            <li class="nav-item">
              <a class="nav-link mx-2" href="http://127.0.0.1:8080/welcome#about"><i class="fas fa-plus-circle pe-2"></i>About us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link mx-2" href="#!"><i class="fas fa-bell pe-2"></i>Alerts</a>
            </li>
            <li class="nav-item">
              <a class="nav-link mx-2" href="http://127.0.0.1:8080/wishlist"><i class="fas fa-heart pe-2"></i>Wishlist</a>
            </li>
            {% if session['username'] %}
            <li class="nav-item ms-3">
              <a class="btn btn-warning btn-sm my-2 my-sm-0" href="http://127.0.0.1:8080/logout">Log out</a>
            </li>
            {% else %}
            <li class="nav-item ms-3">
              <a class="btn btn-warning btn-sm my-2 my-sm-0" href="http://127.0.0.1:8080/login">Sign in</a>
            </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>

<div class="container-fluid m-0 bg-secondary">
  <div class="row">
          <div class="col-12">
              <div class="card card-margin">
                  <div class="card-body">
                      <div class="row search-body">
                          <div class="col-lg-12">
                              <div class="search-result">
                                  <div class="result-header">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <div class="records">Showing: <b>1-20</b> of <b>200</b> result</div>
                                          </div>
                                          <div class="col-lg-6">
                                              <div class="result-actions">
                                                  <div class="result-sorting">
                                                      <span>Sort By:</span>
                                                      <select class="form-control border-0" id="exampleOption">
                                                          <option value="1">Relevance</option>
                                                          <option value="2">Names (A-Z)</option>
                                                          <option value="3">Names (Z-A)</option>
                                                      </select>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                                  <div class="result-body">
                                      <div class="table-responsive">
                                          <table class="table widget-26">
                                              <tbody id="search-result-tbody">
<!-- start of tr -->
                                                  <tr>
                                                      <td>
                                                          <div class="widget-26-job-emp-img">
                                                              <img src="{{ url_for('static', filename='/img/the_study.jpg') }}" alt=""/>
                                                          </div>
                                                      </td>
                                                      <td>
                                                          <div class="widget-26-job-title">
                                                              <a href="#">King Room</a>
                                                              <p class="m-0"><a href="#" class="employer-name">The Study.</a> <span class="text-muted time">1 days ago</span></p>
                                                          </div>
                                                      </td>
                                                      <td>
                                                          <div class="widget-26-job-info">
                                                              <p class="type m-0">University City</p>
                                                              <p class="text-muted m-0">in <span class="location">Philadelphia, PA</span></p>
                                                          </div>
                                                      </td>
                                                      <td>
                                                          <div class="widget-26-job-salary">$ 319/day</div>
                                                      </td>
                                                      <td>
                                                          <div class="widget-26-job-category bg-soft-base">
                                                              <i class="indicator bg-base"></i>
                                                              <span>Excellent 8.8</span>
                                                          </div>
                                                      </td>
                                                      <td>
                                                          <div class="widget-26-job-starred">
                                                              <a href="#">
                                                                  <svg
                                                                      xmlns="http://www.w3.org/2000/svg"
                                                                      width="24"
                                                                      height="24"
                                                                      viewBox="0 0 24 24"
                                                                      fill="none"
                                                                      stroke="currentColor"
                                                                      stroke-width="2"
                                                                      stroke-linecap="round"
                                                                      stroke-linejoin="round"
                                                                      class="feather feather-star"
                                                                  >
                                                                      <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                                                  </svg>
                                                              </a>
                                                          </div>
                                                      </td>
                                                  </tr>
<!-- end of tr -->
                                              </tbody>
                                          </table>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                      <nav class="d-flex justify-content-center">
                          <ul class="pagination pagination-base pagination-boxed pagination-square mb-0">
                              <li class="page-item">
                                  <a class="page-link no-border" href="#">
                                      <span aria-hidden="true">«</span>
                                      <span class="sr-only">Previous</span>
                                  </a>
                              </li>
                              <li class="page-item active"><a class="page-link no-border" href="#">1</a></li>
                              <li class="page-item"><a class="page-link no-border" href="#">2</a></li>
                              <li class="page-item"><a class="page-link no-border" href="#">3</a></li>
                              <li class="page-item"><a class="page-link no-border" href="#">4</a></li>
                              <li class="page-item">
                                  <a class="page-link no-border" href="#">
                                      <span aria-hidden="true">»</span>
                                      <span class="sr-only">Next</span>
                                  </a>
                              </li>
                          </ul>
                      </nav>
                  </div>
              </div>
          </div>
      </div>
  </div>                                                                      

    <!-- example of how to use url_for() -->
    <!-- <img src="{{ url_for('static', filename='/img/doge.png') }}" alt=""> -->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script>
    <script>
        $.get("/api/available",
            {"hotel":"{{ session['hotel'] }}", "fromDate":"{{ session['fromDate'] }}", "toDate": "{{ session['toDate'] }}"},
            (hotels) => { resultHandler(hotels); }     
        );

        function resultHandler(hotels){
            for (var i = 0; i < hotels.length; i++){
                hotel = hotels[i];
                console.log(hotel);
                $("<tr>").addClass("hotel-card")
                    .append(
                        $("<td>").append(
                            $("<div>").addClass("widget-26-job-emp-img").append(
                                $("<img>").attr("src", "{{url_for('static', filename='/img/')}}" + hotel.img)
                            )
                        )
                    )
                    .append(
                        $("<td>").append(
                            $("<div>").addClass("widget-26-job-title").append(
                                $("<a>").text(hotel.hotel)
                            )
                        )
                    )
                    .append(
                        $("<td>").append(
                            $("<div>").addClass("widget-26-job-info").append(
                                $("<p>").addClass("text-muted m-0").text(hotel.neighborhood)
                            ).append(
                                $("<p>").addClass("text-muted m-0").text(hotel.location)
                            )
                        )
                    )
                    .append(
                        $("<td>").append(
                            $("<div>").addClass("widget-26-job-salary").text("$"+hotel.price+" / night")
                        ).append(
                            $("<div>").addClass("widget-26-job-salary").text("From: {{ session['fromDate'] }}")
                        ).append(
                            $("<div>").addClass("widget-26-job-salary").text("To: {{ session['toDate'] }}")
                        )
                    )
                    .append(
                        $("<td>").append(
                            $("<div>").addClass("widget-26-job-category bg-soft-base").append(
                                $("<i>").addClass("indicator big-base")
                            ).append(
                                $("<span>").text(hotel.rating)
                            )
                        )
                    )
                    .append(
                        $("<td>").append(
                            $("<div>").addClass("widget-26-job-starred").append(
                                (hotel.canWishlist == "True") ? 
                                $("<p>").text("Yes") : $("<p>").text("No")
                            )
                        )
                    ).appendTo($("#search-result-tbody"));
            }
        }
    </script>
  </body>
</html>
